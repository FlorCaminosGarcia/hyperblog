"use strict";
const logger_1 = require("./lib/logger");
const typescript_import_plugin_1 = require("./lib/typescript-import-plugin");
const init = ({ typescript }) => {
    let logger;
    const nxImportsPlugin = new typescript_import_plugin_1.NxImportsPlugin(typescript);
    return {
        create(info) {
            logger = logger_1.Logger.create(info);
            logger.log('create');
            nxImportsPlugin.logger = logger;
            if (Object.keys(info.config).length > 0) {
                nxImportsPlugin.setConfig(info.config);
            }
            nxImportsPlugin.addProject(info.project);
            return nxImportsPlugin.decorate(info.languageService);
        },
        onConfigurationChanged(config) {
            logger?.log('onConfigurationChanged called, ' + JSON.stringify(config));
            nxImportsPlugin.setConfig(config);
        },
    };
};
module.exports = init;
